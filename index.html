<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>DDI-CDI Sample generator</title>
	<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
	
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
	
	<link rel="icon" href="resources/ddi-cdi-sample-generator.svg">
	<script src="js/lib/utils.js"></script>
	<script src="js/lib/formatters/ddi-cdi-json-ld.js"></script>
	<script src="js/lib/formatters/ddi-l-xml.js"></script>
	<script src="js/lib/formatters/ddi-c-xml.js"></script>
	<style>
		textarea{
			font-family: monospace;
		}
		.checkbox-xl input{
			margin-top: .1rem;
			width: 2rem;
			height: 2rem;
		}
		@media (min-width: 768px) { 
			form .row .notFirst{
				display:none;
			}
		}
	</style>
</head>

<body>
	<div id="app">
		<nav class="navbar navbar-expand-lg bg-body-tertiary">
			<div class="container-fluid">
				<a class="navbar-brand" href="#">
					<img src="resources/ddi-cdi-sample-generator.svg" alt="DDI-CDI sample generator" height="24">
				</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
					data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
					aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
						<li class="nav-item">
							<button @click="openCsv()" type="button" class="btn btn-light" title="open csv">📂 open csv</button>
						</li>
						<li class="nav-item">
							<button @click="saveCdi()" :disabled="input.fileName == null" type="button" class="btn btn-light" title="save ddi-cdi json-ld">💾 save ddi-cdi</button>
						</li>
						<li class="nav-item">
							<button :disabled="haveCodeLists == false" type="button" class="btn btn-light" title="View and edit codelists">📦 edit codelists</button>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<div v-if="input.fileName == null" class="alert alert-primary d-flex align-items-center gap-2" role="alert">
			<div>
				<strong><span>ℹ️</span>DDI-CDI Sample Generator</strong><br/> 
				Open a csv data file of load one of the examples.<br/>
				<br />
				<strong>🗃️ example csv:s</strong>
				
				<span v-for="e in examples">
					<a @click="loadExample(e)" class="dropdown-item" href="#"><span>📄</span><span v-html="e.fileName"></span></a>
				</span>
			</div>
		</div>
		<div v-if="input.fileName != null">
			<form class="mb-4">
				<div class="row" v-for="column in input.columns">
					<div class="col-md-1">
						<label class="form-label" :class="{notFirst: (column.position != 0)}">Position</label>
						<input v-model="column.position" type="text" class="form-control" disabled>
					</div>
					<div class="col-md-2">
						<label class="form-label" :class="{notFirst: (column.position != 0)}">Name</label>
						<input v-model="column.name" type="text" class="form-control">
					</div>
					<div class="col-md-4">
						<label class="form-label" :class="{notFirst: (column.position != 0)}">Label</label>
						<input v-model="column.displayLabel" type="text" class="form-control">
					</div>
					<div class="col-md-2">
						<label class="form-label" :class="{notFirst: (column.position != 0)}">Role</label>
						<select v-model="column.role" class="form-select" aria-label="Default select example">
							<option v-for="role in cv.colRoles" :value="role.id">{{ role.id }}</option>
						</select>
					</div>
					<div class="col-md-2">
						<label class="form-label" :class="{notFirst: (column.position != 0)}">Type</label>
						<select v-model="column.hasIndendedDataType" class="form-select"
							aria-label="Default select example">
							<option v-for="type in cv.colTypes" :value="type.id">{{ type.label }}</option>
						</select>
					</div>
					<div class="col-md-1">
						<label class="form-label" :class="{notFirst: (column.position != 0)}">Code</label>
						<div class="form-check checkbox-xl">
							<input v-model="column.coded" @change="column.createCodeList()" class="form-check-input" type="checkbox" id="flexCheckChecked">
						</div>
					</div>
				</div>
			</form>
			
			<ul class="nav nav-tabs" id="myTab" role="tablist">
				<li class="nav-item" role="presentation">
				  <button class="nav-link" id="home-tab" data-bs-toggle="tab" data-bs-target="#csv" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="false">📄 csv</button>
				</li>
				<li class="nav-item" role="presentation">
				  <button class="nav-link active" id="profile-tab" data-bs-toggle="tab" data-bs-target="#cdi" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="true">⚗️ ddi-cdi (json-ld)</button>
				</li>
				<li class="nav-item" role="presentation">
				  <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#ddil" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">&lt;&gt; ddi-l (xml)</button>
				</li>
				<li class="nav-item" role="presentation">
				  <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#ddic" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">&lt;&gt; ddi-c (xml)</button>
				</li>
			  </ul>
			  <div class="tab-content" id="myTabContent">
				<div class="tab-pane fade" id="csv" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
					<div class="form-floating mb-3">
						<textarea v-html="input.raw" rows="20" style="height:100%;" class="form-control" placeholder="Imported csv"
							id="importedCsv" style="height: 100px" disabled></textarea>				
					</div>
				</div>
				<div class="tab-pane fade show active" id="cdi" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
					<div class="form-floating mb-3">
						<textarea v-html="cdiOutput" rows="20" style="height:100%;" class="form-control"
							placeholder="DDI-CDI output" id="ddiCdiOutput" style="height: 100px"
							disabled></textarea>
					</div>
				</div>
				<div class="tab-pane fade" id="ddil" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
					<div class="form-floating mb-3">
						<textarea v-html="ddilOutput" rows="10" style="height:100%;" class="form-control"
							placeholder="DDI-CDI output" id="ddiCdiOutput" style="height: 100px"
							disabled></textarea>
					</div>
				</div>
				<div class="tab-pane fade" id="ddic" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
					<div class="form-floating mb-3">
						<textarea v-html="ddicOutput" rows="10" style="height:100%;" class="form-control"
							placeholder="DDI-CDI output" id="ddiCdiOutput" style="height: 100px"
							disabled></textarea>
					</div>
				</div>
			  </div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
	<script src="js/app.js"></script>
</body>

</html>